
<html>

<head>

<style>
body {    margin: 40px; }


/*
:root {
	  --stimwordWord1:  22;
}
*/


.wrapper {
    display: grid;
    max-width: 1000px;
    grid-gap: 10px;
		grid-template-columns: 100px 200px 150px 80px ; 
		background-color: #fff;
		color: #444;
    border: 2px dotted red;
}

.box {
		background-color: #444;
		color: #fff;
		border-radius: 5px;
		padding: 20px;
		font-size: 150%;
   display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;center alignment
  	/*     https://stackoverflow.com/questions/9249359/vertically-align-text-within-a-div
https://stackoverflow.com/questions/2939914/how-do-i-vertically-align-text-in-a-div/13515693#13515693*/
}


</style>


<script>


'use strict;'

var rowCount = 0;
//var colCount = 0;

var controlBreak	=	{}	;
var cssRootRules	=	[]	;

function newRow() { rowCount++; }


function addRecord() {

}

function valueChanged(int) {
	console.log(int);
}

function addItem() {
	debugger;
  let record = data[rowCount] ;
  for ( let columnNbr in Object.keys(data[rowCount]) ) {
	  //maxRow++;  

	  let columnName = Object.keys(data[rowCount])[columnNbr];
	
	   
	  if  (   ( record[columnName] != controlBreak[columnName] )
						   //   ||  (isNaN(parseInt(getComputedStyle(document.body).getPropertyValue(cssVarName))))
	      ) 
	  { 
	   controlBreak[columnName] = record[columnName] ;
		  // null out all subsequent control-break columns!
	   for ( let xx = parseInt(columnNbr) + 1 ; xx < Object.keys(data[rowCount]).length; xx++ )
	   {	console.log(  Object.keys(data[rowCount])[xx] );
		controlBreak[ Object.keys(data[rowCount])[xx]	] = null;  ;
  	   }
	    
	   let cssVarName = '--' + columnName + '--' + (rowCount + 1).toString() ;
	   let tag = document.createElement("div");
	   if  ( columnName == 'clientContextError' ) {
		let inputElement = document.createElement('input');
		inputElement.setAttribute('value', record[columnName]);
		inputElement.setAttribute('id', rowCount);
		inputElement.setAttribute('onChange' , 'valueChanged(' + rowCount + ');' );
	        tag.appendChild(inputElement);
	   } else {
	       let text = document.createTextNode(record[columnName]);
	       tag.appendChild(text);
	   }
	    
	   cssRootRules.push	(	{	'columnName'				:	columnName
					,	'cssVarName'				:	cssVarName
		   			,	'startingRowNbr'			:	rowCount
					,	'endingRowNbr'				:	rowCount
					}
		   		);

           tag.classList.add(columnName, 'box');
	   tag.style.gridRowStart  =	'span var(' + cssVarName + ')'  ;  // 2022-04-19   ?????????????????????????????????	  
	   // 2022-04-19  tag.style.gridRow	=	(rowCount + 1 ).toString()		+ ' / ' +  'var(' + cssVarName + ')'	;
	   tag.style.gridColumn =	(parseInt(columnNbr) + 1).toString()	+ ' / ' +  (parseInt(columnNbr) + 2).toString()	; 

	   document.getElementById('phoneticTranscriptionInputScreen').appendChild(tag);

	  } else {
													  //for ( let cssRuleIncr in Object.keys(cssRootRules).reverse() )
		  for ( let cssRuleIncr = cssRootRules.length - 1 ; cssRuleIncr >= 0; cssRuleIncr-- )
		  {	if  ( cssRootRules[cssRuleIncr].columnName == columnName )	{
				  cssRootRules[cssRuleIncr].endingRowNbr++
				  break;
			}

		 }
		  // working code to manipulate ":root"  :  document.styleSheets[0].insertRule(":root { --stimwordWord--1: 5; --contextPositionSoundPhoneme--1: 5}");
	  }
  }
}
	   //document.body.style.setProperty(cssVarName, rowCount + 1);    // ???????????????????????

function createRootRule() {
	let ruleString = ':root {';
	for ( let incr in cssRootRules ) 
	{	let { startingRowNbr, endingRowNbr, cssVarName } = cssRootRules[incr]	;
		if  ( startingRowNbr != endingRowNbr ) 
		{   ruleString += (' ' + cssVarName + ': ' + (startingRowNbr + ( endingRowNbr - startingRowNbr ) + 2 ).toString() + ';' ) ; 
		}
	}
	ruleString += '}';
	document.styleSheets[0].insertRule(ruleString);
}


const data = 
[ { stimwordWord: 'Horse', contextPositionSoundPhoneme:'Initial - h'	, stimwordPositionSetting:'Word'	, clientContextError: '0'	}
, { stimwordWord: 'Horse', contextPositionSoundPhoneme:'Initial - h'	, stimwordPositionSetting:'Sentence'	, clientContextError: ''	}
, { stimwordWord: 'Horse', contextPositionSoundPhoneme:'Diphthong - oe'	, stimwordPositionSetting:'Word'	, clientContextError: ''	}
, { stimwordWord: 'Horse', contextPositionSoundPhoneme:'Diphthong - oe'	, stimwordPositionSetting:'Sentence'	, clientContextError: ''	}
, { stimwordWord: 'Horse', contextPositionSoundPhoneme:'Final - S'	, stimwordPositionSetting:'Word'	, clientContextError: ''	}
, { stimwordWord: 'Horse', contextPositionSoundPhoneme:'Final - S'	, stimwordPositionSetting:'Sentence'	, clientContextError: ''	}
]

</script>

</head>

<body>

<div id='phoneticTranscriptionInputScreen' class="wrapper">
						<!--
						  <div class='stimwordWord'>Horse</div>
						  <div class='contextPositionSoundPhoneme'>
						    <span id='contextPosition'>Initial</span>
						    <span id='soundPhoneme'>h</span>
						  </div> 
						  <div class='stimwordPositionSetting'>Word</div>
						  <div class='clientContextError'>
						    <input type="text" value='error-11111'></input>
						  </div>


						<div class='stimwordPositionSetting'>Sentence</div>
						<div class='clientContextError'>
						   <input type="text" value='error-2'></input>
						</div>
						-->
</div>

<br />
<button onClick="javascript: addItem();">Add column</button>
<button onClick="javascript: newRow();">next row</button>
	
</body>
</html>

<!--
/*
function shit()  {

	// https://stackoverflow.com/questions/70251599/how-to-use-cssstylesheet-insertrule-to-change-a-root-property

	let varOne = '--varOne';
	let varTwo = '--varTwo';

	debugger;

	console.log('first loopfind: ' );
	let firstRootVars = loopFind();
	console.log(firstRootVars);
	console.log(getComputedStyle(document.body).getPropertyValue(varOne));
	console.log(getComputedStyle(document.body).getPropertyValue(varTwo));

	document.styleSheets[0].insertRule(":root {" + varOne + ": 1234; }");

	console.log('second loopfind: ' );
	let secondRootVars = loopFind();
	console.log(secondRootVars);
	console.log(getComputedStyle(document.body).getPropertyValue(varOne));
	console.log(getComputedStyle(document.body).getPropertyValue(varTwo));

	document.styleSheets[0].removeRule(0)

	console.log('third loopfind: ' );
	let thirdRootVars = loopFind();
	console.log(thirdRootVars);
	console.log(getComputedStyle(document.body).getPropertyValue(varOne));
	console.log(getComputedStyle(document.body).getPropertyValue(varTwo));

	document.styleSheets[0].insertRule(":root {" + varOne + ": 1234; " + varTwo + ": 5678; }");

	console.log('fourth loopfind: ' );
	let fourthRootVars = loopFind();
	console.log(fourthRootVars);
	console.log(getComputedStyle(document.body).getPropertyValue(varOne));
	console.log(getComputedStyle(document.body).getPropertyValue(varTwo));


}

function loopFind() {

	for ( let x = 0 ; x < document.styleSheets[0].cssRules.length ; x++ ) {
		if ( document.styleSheets[0].cssRules[x].selectorText == ':root' ) {
			document.styleSheets[0].removeRule(x)
			break;
		}
	}
}
*/
/*
var sheet = (function() {
	// Create the <style> tag
	var style = document.createElement("style");

	// WebKit hack :(
	style.appendChild(document.createTextNode(""));

	// Add the <style> element to the page
	document.head.appendChild(style);

	return style.sheet;
})();
*/
-->
